<ng-container *ngIf="list">
  <ul [class.horizontal-stack]="horizontalStack !== false" [class.horizontal]="horizontal !== false">
    <ng-container *ngFor="let item of list; let i = index">
      <li>
        <ng-container [ngTemplateOutlet]="template ? withTemplate : withoutTemplate"
                      [ngTemplateOutletContext]="{'$implicit':item, index:i, item:item}"></ng-container>
      </li>
    </ng-container>
  </ul>
</ng-container>

<ng-template #withTemplate let-item let-index>
  <ng-container [ngTemplateOutlet]="template"
                [ngTemplateOutletContext]="{'$implicit':item, 'index': index}"></ng-container>
</ng-template>

<ng-template #withoutTemplate let-item>
  {{item}}
</ng-template>
